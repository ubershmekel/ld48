import{R as e,P as t,g as s,T as i}from"./vendor.cc49dbcf.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(s){const i=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((s,o)=>{const n=new URL(e,i);if(self[t].moduleMap[n])return s(self[t].moduleMap[n]);const l=new Blob([`import * as m from '${n}';`,`${t}.moduleMap['${n}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){o(new Error(`Failed to import: ${e}`)),a(r)},onload(){s(self[t].moduleMap[n]),a(r)}});document.head.appendChild(r)})),self[t].moduleMap={}}}("assets/");var a="./assets/particle-poop-gas.dc46b703.png",o="./assets/test.62dfcf0d.mp3",n="./assets/fly.0506edf4.png",l="./assets/ant-top.4dfd34b0.png";var r={compressionlevel:-1,height:10,infinite:!1,layers:[{data:[93,0,0,0,0,0,0,0,0,93,0,0,0,0,0,0,0,0,0,0,0,0,0,92,0,0,0,0,94,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,93,0,0,0,0,91,0,0,0,0,0,0,0,0,0,0,0,91,0,0,0,0,0,0,0,0,93],height:10,id:1,name:"Tile Layer 1",opacity:1,type:"tilelayer",visible:!0,width:10,x:0,y:0}],nextlayerid:2,nextobjectid:1,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.6.0",tileheight:64,tilesets:[{columns:10,firstgid:1,image:"tilemap.png",imageheight:640,imagewidth:640,margin:0,name:"bob-the-ant",spacing:0,tilecount:100,tileheight:64,tiles:[{id:90,type:"left"},{id:91,type:"right"},{id:92,type:"up"}],tilewidth:64}],tilewidth:64,type:"map",version:"1.6",width:10};function h(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function d(e){return new Promise((t=>setTimeout(t,e)))}function c(e,t){return new Promise((s=>{t.onComplete=s,e.tweens.add(t)}))}window.toggleFullScreen=function(e){!function(){const e=window.document;return e.fullscreenElement&&null!==e.fullscreenElement||e.webkitFullscreenElement&&null!==e.webkitFullscreenElement||e.mozFullScreenElement&&null!==e.mozFullScreenElement||e.msFullscreenElement&&null!==e.msFullscreenElement}()?function(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():console.warn("Did not find request full screen method",e)}(e||document.body):function(){const e=window.document;e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen()}()};const p=new e({wet:1,decay:5,preDelay:.01}).toDestination(),m=new t({velocities:1}).connect(p).toDestination();m.load().then((()=>{console.log("piano loaded!")}));const u=["C2B3E3G3","D2C3F3A4","E2D3G3B4","F2E3A3C4","G2F3B3D4","C3E3G3C4"];async function g(e,t){const s=e.match(/.{2}/g)||[];for(const i of s)m.keyDown({note:i,velocity:.5});await d(1e3*t);for(const i of s)m.keyUp({note:i}),await d(.3*Math.random());return d(1e3*t+100)}document.addEventListener("visibilitychange",(e=>{"visible"==document.visibilityState?s().mute=!1:s().mute=!0}));class y extends Phaser.Scene{constructor(){super({key:"MenuScene"}),this.sprites=[]}preload(){this.startKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.startKey.isDown=!1,this.load.image("particle",a),this.load.audio("overture",o),this.load.image("tiles","./assets/tilemap.118f3657.png"),this.load.image("fly",n),this.load.image("ant-top",l),this.load.image("splashScreen","./assets/splashScreen.6c98c9d2.png"),this.load.tilemapTiledJSON("map",r)}create(){this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"splashScreen");for(let e=0;e<100;e++){const e=Phaser.Math.Between(300,600),t=Phaser.Math.Between(-64,600),s=this.add.image(e,t,"particle");s.setBlendMode(Phaser.BlendModes.NORMAL),this.sprites.push({s:s,r:2+6*Math.random()})}this.input.once("pointerup",(e=>{this.exitMenu()}))}exitMenu(){!async function(){g(u[0],.8)}(),this.scene.start("DigScene")}update(){this.startKey.isDown&&this.exitMenu();for(let e=0;e<this.sprites.length;e++){const t=this.sprites[e].s;t.y-=this.sprites[e].r,t.y<-256&&(t.y=700)}}}class f extends Phaser.Physics.Arcade.Image{constructor(e,t,s){super(e,t,s,"ant-top"),this.isAlive=!1,this.target=new Phaser.Math.Vector2,this.speed=100,this.setScale(.2),e.add.existing(this),e.physics.add.existing(this);const{LEFT:i,RIGHT:a,UP:o,W:n,A:l,D:r}=Phaser.Input.Keyboard.KeyCodes;this.keys=e.input.keyboard.addKeys({left:i,right:a,up:o,w:n,a:l,d:r})}start(){this.isAlive=!0}preUpdate(){if(this.isAlive){const e=this.scene.input.activePointer.positionToCamera(this.scene.cameras.main);this.target.x=e.x,this.target.y=e.y,this.rotation=this.scene.physics.moveToObject(this,this.target,this.speed)+Math.PI/2}(!this.isAlive||Phaser.Math.Distance.Between(this.x,this.y,this.target.x,this.target.y)<20)&&this.body.reset(this.x,this.y)}}class w{constructor(e){this.scene=e;const t=+e.sys.game.config.width,s=t-40,i=+e.sys.game.config.height-150-20,a=e.add.graphics();this.graphics=a,a.fillStyle(3618615,.8),a.fillRect(21,i+1,s-1,149),a.lineStyle(3,4212632,1),a.strokeRect(20,i,s,150),a.setScrollFactor(0);const o=e.make.text({x:30,y:i+10,text:"",style:{wordWrap:{width:t-40-25},fontSize:"26px"}});o.setScrollFactor(0),this.sceneText=o,o.depth=9,a.depth=9}moveToTop(){const e=+this.scene.sys.game.config.height;this.sceneText.y=30,this.graphics.y=150-e+20+20}moveToBottom(){const e=+this.scene.sys.game.config.height-150-20;this.sceneText.y=e+10,this.graphics.y=0}setText(e){const t=this.sceneText;return t.setText(""),new Promise((s=>{const i=this.scene.time.addEvent({delay:10,callback:()=>{const a=t.text.length;a>=e.length?(i.remove(),s()):t.setText(t.text+e[a])},loop:!0})}))}hide(){this.sceneText.visible=!1,this.graphics.visible=!1}show(){this.sceneText.visible=!0,this.graphics.visible=!0}}const b=[["There you are, Bob!","Fewf, that was a close one."],["What is it, do you like the smell?","Nope, I just like the elephants."],["Why do you keep getting in deeper and deeper sh-","It's only game, why you heff to be mad?"],["Mom is going to be worried","Crap! We should go home."],["That's it! We're going home right now!","Yeah, I'm all pooped out."],["Is this game some sort of black comedy?","More like brown comedy..."],["How deep does it go?","I don't think the dude gave this game a limit..."],["What's brown and sounds like a bell?","Dung!"],["What kind of webapp do you make in the toilet?","CRUD!"],["Is diarrhea hereditary?","It does run in jeans..."],["Bob, what's a palindrome?","It's like poop..."],['This is the "end" of the game',"Congratulations! You can keep going if you like..."],["Can I ask for a favor?","Could you leave a comment on the Ludum Dare page with which level you made it to?"]],v=[5320725,5583136,5780261,7095062];class x extends Phaser.Scene{constructor(){super({key:"DigScene"}),this.sprites=[],this.level=1,this.timeElapsedMs=0,this.startDistance=1e9}init(e){this.level=e.level||1}preload(){this.startKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.startKey.isDown=!1,this.load.image("particle",a),this.load.audio("overture",o),this.load.image("tiles","./assets/tilemap.118f3657.png"),this.load.image("fly",n),this.load.image("foundBob","./assets/foundBob.c84f872f.png"),this.load.image("poopFalafel","./assets/poopFalafel.a3d83b62.png"),this.load.image("ant-top",l),this.load.tilemapTiledJSON("map",r),this.load.image("ground","./assets/ground.4566660e.png"),this.load.image("elephant","./assets/elephant.8461404c.png")}createMap(){const e=this.make.tilemap({key:"map"}),t=e.addTilesetImage("bob-the-ant","tiles");this.groundLayer=e.createLayer("Tile Layer 1",t),this.marker=this.add.graphics(),this.marker.lineStyle(5,16777215,1),this.marker.strokeRect(0,0,e.tileWidth,e.tileHeight),this.marker.lineStyle(3,16732024,1),this.marker.strokeRect(0,0,e.tileWidth,e.tileHeight)}generatePoopMap(e){const t=100;let s=e,i=0,a=0;const o=[];for(;s>0;){for(let e=0;e<s;e++){const s=120+e*t+12.5*Math.random()+a*t,r=-80-80*i+10*Math.random(),h=this.add.image(s,r,"poopFalafel");h.tint=v[Math.floor(Math.random()*v.length)],h.scale=(n=.9,l=1.1,Math.random()*(l-n)+n),o.push(h)}s-=1,Math.random()>.5&&(s-=1),i+=1,s>1&&(a+=h(-1,1))}var n,l;let r=h(0,o.length-1);o.length>1&&0==r&&(r=1),this.bobTarget=o[r],this.startDistance=Phaser.Math.Distance.BetweenPoints(this.player,this.bobTarget),this.physics.add.existing(this.bobTarget),this.physics.add.overlap(this.player,this.bobTarget,this.levelEnd,void 0,this)}async levelEnd(e,t){const s=e,a=t;if(!s.isAlive)return;let o=null;this.level-1<b.length&&(o=this.dialog.setText(b[this.level-1][0]),this.dialog.show()),s.isAlive=!1,console.log("Found bob!",s,a),i.stop(),g("C3E5G5C5",1.6),c(this,{targets:a,scale:1.3,duration:300}),await d(100),a.depth=1;const n=this.add.image(a.x,a.y,"foundBob");n.alpha=0,n.depth=3,c(this,{targets:n,duration:300,alpha:1}),await c(this,{targets:n,duration:600,y:"+=40",ease:"Bounce.easeOut"}),o&&(await o,await d(1e3),this.dialog.moveToTop(),await this.dialog.setText(b[this.level-1][1])),await d(1500),this.scene.restart({level:this.level+1})}createBackground(){this.cameras.main.backgroundColor=Phaser.Display.Color.HexStringToColor("#4499ee");const e=this.add.image(0,-90,"ground");e.setOrigin(.5,0),e.displayWidth=4e3,e.displayHeight=600;const t=this.add.image(-100,0,"elephant");t.setOrigin(1,1),t.scale=2}create(){this.createBackground(),this.dialog=new w(this),1===this.level?(this.dialog.setText("I can't believe Bob got lost in the poop. Conveniently, the piano 🎹 plays a higher note ♯🎵 when I get closer to Bob 🐜."),this.dialog.moveToBottom()):this.dialog.hide(),this.player=new f(this,0,0),this.add.image(100,100,"particle"),this.generatePoopMap(this.level+5),this.instructions=this.add.text(-100,0,"Tap/click to start",{fontSize:"60px",fontFamily:"Helvetica"});this.add.text(10,10,"Level "+this.level,{fontSize:"30px",fontFamily:"Helvetica"}).setScrollFactor(0),this.input.once("pointerup",(e=>{this.start()})),this.player.depth=2}start(){this.player.start(),this.instructions.setVisible(!1),this.giveDistanceUpdate(),this.dialog.hide()}giveDistanceUpdate(){!async function(e){e>.99&&(e=.99),e<0&&(e=0);const t=u.length-Math.floor(u.length*e)-1;g(u[t],.8)}(Phaser.Math.Distance.BetweenPoints(this.player,this.bobTarget)/this.startDistance)}update(e,t){this.player.isAlive&&(this.timeElapsedMs+=t,this.timeElapsedMs>3e3&&(this.timeElapsedMs-=3e3,this.giveDistanceUpdate())),this.cameras.main.startFollow(this.player),this.startKey.isDown&&this.scene.start(this);for(let s=0;s<this.sprites.length;s++){const e=this.sprites[s].s;e.y-=this.sprites[s].r,e.y<-256&&(e.y=700)}if(this.marker){const e=this.input.activePointer.positionToCamera(this.cameras.main),t=this.groundLayer.worldToTileXY(e.x,e.y),s=this.groundLayer.tileToWorldXY(t.x,t.y);this.marker.setPosition(s.x,s.y)}}}const k={title:"Where is Bob",url:"https://yuvalg.com",version:"2.0",width:800,height:600,type:Phaser.AUTO,parent:"app",scene:[x,y],input:{keyboard:!0},physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},backgroundColor:"#000000",render:{pixelArt:!1,antialias:!0},audio:{disableWebAudio:!1},scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH}};class T extends Phaser.Game{constructor(e){super(e)}}window.addEventListener("load",(()=>{window._game=new T(k)}));
