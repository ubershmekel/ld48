import{R as e,P as t,g as s}from"./vendor.ef23ac13.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(s){const i=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((s,n)=>{const r=new URL(e,i);if(self[t].moduleMap[r])return s(self[t].moduleMap[r]);const o=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){n(new Error(`Failed to import: ${e}`)),a(l)},onload(){s(self[t].moduleMap[r]),a(l)}});document.head.appendChild(l)})),self[t].moduleMap={}}}("assets/");var i="./assets/particle-poop-gas.dc46b703.png",a="./assets/test.62dfcf0d.mp3",n="./assets/fly.0506edf4.png",r="./assets/ant-top.4dfd34b0.png";var o={compressionlevel:-1,height:10,infinite:!1,layers:[{data:[93,0,0,0,0,0,0,0,0,93,0,0,0,0,0,0,0,0,0,0,0,0,0,92,0,0,0,0,94,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,93,0,0,0,0,91,0,0,0,0,0,0,0,0,0,0,0,91,0,0,0,0,0,0,0,0,93],height:10,id:1,name:"Tile Layer 1",opacity:1,type:"tilelayer",visible:!0,width:10,x:0,y:0}],nextlayerid:2,nextobjectid:1,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.6.0",tileheight:64,tilesets:[{columns:10,firstgid:1,image:"tilemap.png",imageheight:640,imagewidth:640,margin:0,name:"bob-the-ant",spacing:0,tilecount:100,tileheight:64,tiles:[{id:90,type:"left"},{id:91,type:"right"},{id:92,type:"up"}],tilewidth:64}],tilewidth:64,type:"map",version:"1.6",width:10};const l=new e({wet:1,decay:5,preDelay:.01}).toDestination(),h=new t({velocities:1}).connect(l).toDestination();h.load().then((()=>{console.log("piano loaded!")}));const c=["C2B3E3G3","D2C3F3A4","E2D3G3B4","F2E3A3C4","G2F3B3D4","C3E3G3C4"];function d(e){return new Promise((t=>setTimeout(t,e)))}async function p(e,t){const s=e.match(/.{2}/g)||[];for(const i of s)h.keyDown({note:i,velocity:.5});await d(1e3*t);for(const i of s)h.keyUp({note:i}),await d(.3*Math.random());return d(1e3*t+100)}document.addEventListener("visibilitychange",(e=>{"visible"==document.visibilityState?s().mute=!1:s().mute=!0}));class u extends Phaser.Scene{constructor(){super({key:"MenuScene"}),this.sprites=[]}preload(){this.startKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.startKey.isDown=!1,this.load.image("particle",i),this.load.audio("overture",a),this.load.image("tiles","./assets/tilemap.118f3657.png"),this.load.image("fly",n),this.load.image("ant-top",r),this.load.image("splashScreen","./assets/splashScreen.6c98c9d2.png"),this.load.tilemapTiledJSON("map",o)}create(){this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"splashScreen");for(let e=0;e<100;e++){const e=Phaser.Math.Between(300,600),t=Phaser.Math.Between(-64,600),s=this.add.image(e,t,"particle");s.setBlendMode(Phaser.BlendModes.NORMAL),this.sprites.push({s:s,r:2+6*Math.random()})}this.input.once("pointerup",(e=>{this.exitMenu()}))}exitMenu(){!async function(){p(c[0],.8)}(),this.scene.start("DigScene")}update(){this.startKey.isDown&&this.exitMenu();for(let e=0;e<this.sprites.length;e++){const t=this.sprites[e].s;t.y-=this.sprites[e].r,t.y<-256&&(t.y=700)}}}class m extends Phaser.Physics.Arcade.Image{constructor(e,t,s){super(e,t,s,"ant-top"),this.isAlive=!1,this.target=new Phaser.Math.Vector2,this.speed=100,this.setScale(.2),e.add.existing(this),e.physics.add.existing(this);const{LEFT:i,RIGHT:a,UP:n,W:r,A:o,D:l}=Phaser.Input.Keyboard.KeyCodes;this.keys=e.input.keyboard.addKeys({left:i,right:a,up:n,w:r,a:o,d:l})}start(){this.isAlive=!0,this.scene.input.on("pointermove",(e=>{}))}preUpdate(){if(this.isAlive){const e=this.scene.input.activePointer.positionToCamera(this.scene.cameras.main);this.target.x=e.x,this.target.y=e.y,this.rotation=this.scene.physics.moveToObject(this,this.target,this.speed)+Math.PI/2}Phaser.Math.Distance.Between(this.x,this.y,this.target.x,this.target.y)<20&&this.body.reset(this.x,this.y)}}function g(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}window.toggleFullScreen=function(e){!function(){const e=window.document;return e.fullscreenElement&&null!==e.fullscreenElement||e.webkitFullscreenElement&&null!==e.webkitFullscreenElement||e.mozFullScreenElement&&null!==e.mozFullScreenElement||e.msFullscreenElement&&null!==e.msFullscreenElement}()?function(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():console.warn("Did not find request full screen method",e)}(e||document.body):function(){const e=window.document;e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen()}()};const y=[5320725,5583136,5780261,7095062];class f extends Phaser.Scene{constructor(){super({key:"DigScene"}),this.sprites=[],this.level=1,this.timeElapsedMs=0,this.startDistance=1e9}init(e){this.level=e.level||1}preload(){this.startKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.startKey.isDown=!1,this.load.image("particle",i),this.load.audio("overture",a),this.load.image("tiles","./assets/tilemap.118f3657.png"),this.load.image("fly",n),this.load.image("poopFalafel","./assets/poopFalafel.a3d83b62.png"),this.load.image("ant-top",r),this.load.tilemapTiledJSON("map",o),this.load.image("ground","./assets/ground.4566660e.png"),this.load.image("elephant","./assets/elephant.8461404c.png")}createMap(){const e=this.make.tilemap({key:"map"}),t=e.addTilesetImage("bob-the-ant","tiles");this.groundLayer=e.createLayer("Tile Layer 1",t),this.marker=this.add.graphics(),this.marker.lineStyle(5,16777215,1),this.marker.strokeRect(0,0,e.tileWidth,e.tileHeight),this.marker.lineStyle(3,16732024,1),this.marker.strokeRect(0,0,e.tileWidth,e.tileHeight)}generatePoopMap(e){const t=100;let s=e,i=0,a=0;const n=[];for(;s>0;){for(let e=0;e<s;e++){const s=120+e*t+12.5*Math.random()+a*t,l=-80-80*i+10*Math.random(),h=this.add.image(s,l,"poopFalafel");h.tint=y[Math.floor(Math.random()*y.length)],h.scale=(r=.9,o=1.1,Math.random()*(o-r)+r),n.push(h)}s-=1,Math.random()>.5&&(s-=1),i+=1,s>1&&(a+=g(-1,1))}var r,o;let l=g(0,n.length-1);n.length>1&&0==l&&(l=1),this.bobTarget=n[l],this.startDistance=Phaser.Math.Distance.BetweenPoints(this.player,this.bobTarget),this.physics.add.existing(this.bobTarget),this.physics.add.overlap(this.player,this.bobTarget,this.foundBob,void 0,this)}foundBob(e,t){e.isAlive&&(console.log("Found bob!",e,t),t.scale=2,this.scene.restart({level:this.level+1})),e.isAlive=!1}createBackground(){this.cameras.main.backgroundColor=Phaser.Display.Color.HexStringToColor("#4499ee");const e=this.add.image(0,-90,"ground");e.setOrigin(.5,0),e.displayWidth=4e3,e.displayHeight=600;const t=this.add.image(-100,0,"elephant");t.setOrigin(1,1),t.scale=2}create(){this.createBackground(),this.player=new m(this,0,0),this.add.image(100,100,"particle"),this.generatePoopMap(this.level+5),this.instructions=this.add.text(-100,0,"Tap/click to start",{fontSize:"60px",fontFamily:"Helvetica"});this.add.text(10,10,"Level "+this.level,{fontSize:"30px",fontFamily:"Helvetica"}).setScrollFactor(0),this.input.once("pointerup",(e=>{this.start()})),this.player.depth=1}start(){this.player.start(),this.instructions.setVisible(!1),this.giveDistanceUpdate()}giveDistanceUpdate(){!async function(e){e>.99&&(e=.99),e<0&&(e=0);const t=c.length-Math.floor(c.length*e)-1;p(c[t],.8)}(Phaser.Math.Distance.BetweenPoints(this.player,this.bobTarget)/this.startDistance)}update(e,t){this.player.isAlive&&(this.timeElapsedMs+=t,this.timeElapsedMs>3e3&&(this.timeElapsedMs-=3e3,this.giveDistanceUpdate())),this.cameras.main.startFollow(this.player),this.startKey.isDown&&this.scene.start(this);for(let s=0;s<this.sprites.length;s++){const e=this.sprites[s].s;e.y-=this.sprites[s].r,e.y<-256&&(e.y=700)}if(this.marker){const e=this.input.activePointer.positionToCamera(this.cameras.main),t=this.groundLayer.worldToTileXY(e.x,e.y),s=this.groundLayer.tileToWorldXY(t.x,t.y);this.marker.setPosition(s.x,s.y)}}}const b={title:"Where is Bob",url:"https://yuvalg.com",version:"2.0",width:800,height:600,type:Phaser.AUTO,parent:"app",scene:[f,u],input:{keyboard:!0},physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},backgroundColor:"#000000",render:{pixelArt:!1,antialias:!0},audio:{disableWebAudio:!1},scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH}};class w extends Phaser.Game{constructor(e){super(e)}}window.addEventListener("load",(()=>{window._game=new w(b)}));
